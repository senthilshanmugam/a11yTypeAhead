"use strict";angular.module("a11yComponentsApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","a11yModule"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("a11yComponentsApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("a11yComponentsApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]});var a11yModule=angular.module("a11yModule",[]);a11yModule.factory("a11yCommon",["$q","$timeout",function(a,b){return{getKeyCodes:function(){return{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:46}},getFilteredStates:function(a){var b=new RegExp("^"+a,"i"),c=this.USStates.filter(function(a){return b.test(a.name)});return c},getFilteredCities:function(a){var b=new RegExp("^"+a,"i"),c=this.USCities.filter(function(a){return b.test(a)});return c},getFilteredCountries:function(a){var b=new RegExp("^"+a,"i"),c=this.AsianCountries.filter(function(a){return b.test(a.name)});return c},USStates:[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AS",name:"American Samoa"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DE",name:"Delaware"},{code:"DC",name:"District of Columbia"},{code:"FL",name:"Florida"},{code:"GA",name:"Georgia"},{code:"GU",name:"Guam"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"MP",name:"Northern Marianas Islands"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PA",name:"Pennsylvania"},{code:"PR",name:"Puerto Rico"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VA",name:"Virginia"},{code:"VI",name:"Virgin Islands"},{code:"WA",name:"Washington"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"},{code:"OR",name:"New Oregon"},{code:"PA",name:"New Pennsylvania"},{code:"PR",name:"New Puerto Rico"},{code:"RI",name:"New Rhode Island"},{code:"SC",name:"New South Carolina"},{code:"SD",name:"New South Dakota"},{code:"OK",name:"New Oklahoma New Oklahoma New Oklahoma New Oklahoma New Oklahoma"},{code:"TN",name:"New Tennessee"},{code:"TX",name:"New Texas"},{code:"UT",name:"New Utah"},{code:"VT",name:"New Vermont"},{code:"VA",name:"New Virginia"},{code:"VI",name:"New Virgin Islands"},{code:"WA",name:"New Washington"},{code:"WV",name:"New West Virginia"},{code:"WI",name:"New Wisconsin"},{code:"WY",name:"New Wyoming"}],USCities:["Abilene","Akron","Albuquerque","Alexandria","Allentown","Amarillo","Anaheim","Anchorage","Ann Arbor","Antioch","Arlington","Arvada","Athens","Atlanta","Augusta","Aurora","Austin","Bakersfield","Baltimore","Baton Rouge","Beaumont","Bellevue","Berkeley","Billings","Birmingham","Boise","Boston","Boulder","Bridgeport","Broken Arrow","Brownsville","Buffalo","Burbank","Cambridge","Cape Coral","Carlsbad","Carrollton","Cary","Cedar Rapids","Centennial","Chandler","Charleston","Charlotte","Chattanooga","Chesapeake","Chicago","Chula Vista","Cincinnati","Clarksville","Clearwater","Cleveland","Clovis","College Station","Colorado Springs","Columbia","Columbus","Concord","Coral Springs","Corona","Corpus Christi","Costa Mesa","Dallas","Daly City","Davenport","Davie","Dayton","Denton","Denver","Des Moines","Detroit","Downey","Durham","Edison","El Cajon","El Monte","El Paso","Elgin","Elizabeth","Elk Grove","Escondido","Eugene","Evansville","Everett","Fairfield","Fargo","Fayetteville","Fontana","Fort Collins","Fort Lauderdale","Fort Wayne","Fort Worth","Fremont","Fresno","Frisco","Fullerton","Gainesville","Garden Grove","Garland","Gilbert","Glendale","Grand Prairie","Grand Rapids","Greeley","Green Bay","Greensboro","Gresham","Hampton","Hartford","Hayward","Henderson","Hialeah","High Point","Hillsboro","Hollywood","Honolulu","Houston","Huntington Beach","Huntsville","Independence","Indianapolis","Inglewood","Irvine","Irving","Jackson","Jacksonville","Jersey City","Joliet","Jurupa Valley","Kansas City","Kent","Killeen","Knoxville","Lafayette","Lakeland","Lakewood","Lancaster","Lansing","Laredo","Las Cruces","Las Vegas","Lewisville","Lexington","Lincoln","Little Rock","Long Beach","Los Angeles","Louisville","Lowell","Lubbock","Macon","Madison","Manchester","McAllen","McKinney","Memphis","Mesa","Mesquite","Miami","Miami Gardens","Midland","Milwaukee","Minneapolis","Miramar","Mobile","Modesto","Montgomery","Moreno Valley","Murfreesboro","Murrieta","Naperville","Nashville","New Haven","New Orleans","New York","Newark","Newport","Norfolk","Norman","North Charleston","North Las Vegas","Norwalk","Oakland","Oceanside","Odessa","Oklahoma City","Olathe","Omaha","Ontario","Orange","Orlando","Overland Park","Oxnard","Palm Bay","Palmdale","Pasadena","Paterson","Pearland","Pembroke Pines","Peoria","Philadelphia","Phoenix","Pittsburgh","Plano","Pomona","Pompano Beach","Port St. Lucie","Portland","Providence","Provo","Pueblo","Raleigh","Rancho Cucamonga","Reno","Renton","Rialto","Richardson","Richmond","Riverside","Rochester","Rockford","Roseville","Round Rock","Sacramento","Saint Paul","Salem","Salinas","Salt Lake City","San Angelo","San Antonio","San Bernardino","San Diego","San Francisco","San Jose","San Mateo","Sandy Springs","Santa Ana","Santa Clara","Santa Clarita","Santa Maria","Santa Rosa","Savannah","Scottsdale","Seattle","Shreveport","Simi Valley","Sioux Falls","South Bend","Spokane","Springfield","St. Louis","St. Petersburg","Stamford","Sterling Heights","Stockton","Sunnyvale","Surprise","Syracuse","Tacoma","Tallahassee","Tampa","Temecula","Tempe","Thornton","Thousand Oaks","Toledo","Topeka","Torrance","Tucson","Tulsa","Tyler","Vallejo","Vancouver","Ventura","Victorville","Virginia Beach","Visalia","Vista","Waco","Warren","Washington","Waterbury","West Covina","West Jordan","West Palm Beach","West Valley City","Westminster","Wichita","Wichita Falls","Wilmington","Winston","Woodbridge","Worcester","Yonkers"],AsianCountries:[{code:"AF",name:"Afghanistan"},{code:"AR",name:"Armenia"},{code:"AZ",name:"Azerbaijan"},{code:"BA",name:"Bahrain"},{code:"BN",name:"Bangladesh"},{code:"BH",name:"Bhutan"},{code:"BR",name:"Brunei"},{code:"CA",name:"Cambodia"},{code:"CH",name:"China"},{code:"CY",name:"Cyprus"},{code:"GE",name:"Georgia"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IA",name:"Iraq"},{code:"IS",name:"Israel"},{code:"JA",name:"Japan"},{code:"JO",name:"Jordan"},{code:"KA",name:"Kazakhstan"},{code:"KU",name:"Kuwait"},{code:"KY",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LE",name:"Lebanon"},{code:"MA",name:"Malaysia"},{code:"ML",name:"Maldives"},{code:"MO",name:"Mongolia"},{code:"MY",name:"Myanmar (Burma)"},{code:"NE",name:"Nepal"},{code:"NO",name:"North Korea"},{code:"OM",name:"Oman"},{code:"PA",name:"Pakistan"},{code:"PL",name:"Palestine"},{code:"PH",name:"Philippines"},{code:"QA",name:"Qatar"},{code:"RU",name:"Russia"},{code:"SA",name:"Saudi Arabia"},{code:"SI",name:"Singapore"},{code:"SO",name:"South Korea"},{code:"SR",name:"Sri Lanka"},{code:"SY",name:"Syria"},{code:"TA",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TH",name:"Thailand"},{code:"TI",name:"Timor-Leste"},{code:"TU",name:"Turkey"},{code:"TK",name:"Turkmenistan"},{code:"UA",name:"United Arab Emirates"},{code:"UZ",name:"Uzbekistan"},{code:"VI",name:"Vietnam"},{code:"YE",name:"Yemen"}],WeekDays:[{abbr:"Sun",fullName:"Sunday"},{abbr:"Mon",fullName:"Monday"},{abbr:"Tue",fullName:"Tuesday"},{abbr:"Wed",fullName:"Wednesday"},{abbr:"Thu",fullName:"Thrusday"},{abbr:"Fri",fullName:"Friday"},{abbr:"Sat",fullName:"Saturday"}],CalenderMonths:[{abbr:"Jan",fullName:"January"},{abbr:"Feb",fullName:"February"},{abbr:"Mar",fullName:"March"},{abbr:"Apr",fullName:"April"},{abbr:"May",fullName:"May"},{abbr:"Jun",fullName:"June"},{abbr:"Jul",fullName:"July"},{abbr:"Aug",fullName:"August"},{abbr:"Sep",fullName:"September"},{abbr:"Oct",fullName:"October"},{abbr:"Nov",fullName:"November"},{abbr:"Dec",fullName:"December"}]}}]),a11yModule.directive("a11yTypeAhead",["$timeout","$sce","$compile","a11yCommon",function(a,b,c,d){return{restrict:"E",replace:!0,transclude:!0,scope:{a11yUid:"@",a11yAriaLabel:"@",searchTreshold:"@",onSearch:"&",getOptionTemplate:"&",getOptionText:"&",onSelect:"&",selectedText:"="},templateUrl:"a11yTypeAhead/a11yTypeAhead.html",link:function(c,e,f){keys=d.getKeyCodes(),c.suggestions=null,taTimerPromise=null,c.searchRequestCounter=0,a(function(){c.taLabel=e.find("#"+c.a11yUid+"-label"),c.taEdit=e.find("#"+c.a11yUid+"-edit"),c.taListBox=e.find("#"+c.a11yUid+"-list"),c.taOptions=c.taListBox.find("li"),c.taSelected=c.taOptions.filter(".selected"),""==c.taLabel.text()&&c.taLabel.text(c.a11yUid),c.searchTreshold=parseInt(c.searchTreshold),isNaN(c.searchTreshold)&&(c.searchTreshold=3)},200),c.textBoxKeyDown=function(b){var d=c.taOptions.filter(".selected"),e=c.taOptions.index(d);switch(b.keyCode){case keys.tab:return c.selectOption(d,!1),1==c.isOpen()&&c.hideOption(),!0;case keys.esc:return c.itemSelect(c.taSelected,!1),c.taEdit.select(),1==c.isOpen()&&c.hideOption(),b.stopPropagation(),!1;case keys.enter:return b.shiftKey||b.altKey||b.ctrlKey?!0:(0==c.isOpen()?c.taOptions.length>0&&c.showOption():(c.selectOption(d,d[0]!==c.taSelected[0]),c.hideOption(),a(function(){c.taEdit.focus()},5)),c.taEdit.select(),b.stopPropagation(),!1);case keys.up:if(b.shiftKey||b.ctrlKey)return!0;if(b.altKey&&c.isOpen())c.selectOption(d,d[0]!==c.taSelected[0]),c.taEdit.select(),c.hideOption();else if(e>0){var f=c.taOptions.eq(e-1);d.removeClass("selected"),f.addClass("selected"),1==c.isOpen()?(c.itemSelect(f,!1),c.taListBox.scrollTop(c.getScrollPos(f))):c.itemSelect(f,!0),a(function(){c.taEdit.select()},1)}return b.stopPropagation(),!1;case keys.down:if(b.shiftKey||b.ctrlKey)return!0;if(b.altKey&&!c.isOpen()&&c.taOptions.length>0)c.showOption();else if(e<c.taOptions.length-1){var f=c.taOptions.eq(e+1);d.removeClass("selected"),f.addClass("selected"),1==c.isOpen()?(c.itemSelect(f,!1),c.taListBox.scrollTop(c.getScrollPos(f))):c.itemSelect(f,!0),a(function(){c.taEdit.select()},1)}return b.stopPropagation(),!1}return!0},c.textBoxKeyUp=function(b){if(b.shiftKey||b.ctrlKey||b.altKey)return!0;switch(b.keyCode){case keys.shift:case keys.ctrl:case keys.alt:case keys.esc:case keys.tab:case keys.enter:case keys.left:case keys.right:case keys.up:case keys.down:case keys.home:case keys.end:return!0}(b.keyCode==keys.backspace||b.keyCode==keys.del)&&c.clearOption();var d=c.taEdit.val();return d.length>=c.searchTreshold?(a.cancel(c.searchTimer),c.searchTimer=a(function(){function b(b,d){c.onSearch({searchString:b}).then(function(e){console.log("searchCounter "+d+"  searchString "+b+"  searchRC"+c.searchRequestCounter+'"'),d==c.searchRequestCounter&&(console.log("passed"),c.searchRequestCounter=0,c.suggestions=e,e.length>0?(a(function(){c.taOptions=c.taListBox.find("li"),c.taEdit.val().length<c.searchTreshold&&c.clearOption("No Suggestions available.")},1),c.isFocus()&&($("#"+c.a11yUid+"-result").text("We have received "+e.length+" suggestions.  Please use up/down arrow to select"),c.isOpen()||c.showOption())):c.clearOption("No Suggestions available."))})}$("#"+c.a11yUid+"-result").text("Please wait while we fetch suggestions."),b(d,++c.searchRequestCounter)},500)):c.clearOption("No Suggestions available."),b.stopPropagation(),!1},c.textBoxBlur=function(b){return console.log("textBoxBlur"),1==c.isOpen()&&(c.selectOption(c.taOptions.filter(".selected"),!1),a.cancel(taTimerPromise),taTimerPromise=a(function(){c.hideOption()},200)),$("#"+c.a11yUid+"-result").text(""),a(function(){c.taEdit.removeAttr("aria-activedescendant")},1e3),!0},c.textBoxFocus=function(b){console.log("textBoxFocus"),a(function(){c.taEdit.removeAttr("aria-activedescendant"),c.taEdit.attr("aria-activedescendant")&&""!=c.taEdit.attr("aria-activedescendant")||c.taSelected.attr("id")&&c.taEdit.attr("aria-activedescendant",c.taSelected.attr("id"))},1e3)},c.listBoxFocus=function(b){return a.cancel(taTimerPromise),c.taEdit.focus(),b.stopPropagation(),!1},c.listBoxClick=function(b){if("UL"==angular.element(b.target)[0].nodeName)return!0;var d;d="LI"!=b.target.nodeName?"#"+$(b.target).parents("li").attr("id"):"#"+b.target.id;var e=c.taOptions.filter(d);return c.selectOption(e,e[0]!==c.taSelected[0]),c.taEdit.select(),c.hideOption(),a(function(){c.taEdit.focus()},200),b.stopPropagation(),!1},c.itemSelect=function(b,d){if(console.log('itemSelect "'+b.text()+'"'),0!=b.length){var e=c.getOptionText({itemSelected:c.suggestions[c.taOptions.index(b)]});e||(e=b.text()),c.taEdit.val(e),c.taEdit.attr("aria-activedescendant",b.attr("id")),d&&(c.taSelected=b,c.selectedText=b.text(),a(function(){c.isFocus()&&c.onSelect()},10))}},c.isFocus=function(){return document.activeElement.id==c.taEdit.get(0).id},c.isOpen=function(){return"block"==c.taListBox.css("display")},c.hideOption=function(){c.taOptions.removeClass("selected"),c.taSelected.addClass("selected"),c.taListBox.hide(),c.taEdit.attr("aria-expanded","false")},c.showOption=function(){c.taOptions.removeClass("selected"),c.taSelected.addClass("selected"),c.taListBox.show(),c.taEdit.attr("aria-expanded","true"),0==c.taSelected.length&&c.selectOption(c.taOptions.first(),!1),c.taListBox.css({"margin-left":c.taEdit.offset().left-c.taLabel.offset().left,width:c.taEdit.outerWidth()}).scrollTop(c.getScrollPos(c.taSelected))},c.selectOption=function(a,b){c.taOptions.removeClass("selected"),c.taSelected=a.addClass("selected"),c.itemSelect(c.taSelected,b)},c.clearOption=function(a){$("#"+c.a11yUid+"-result").text(a),c.suggestions=null,c.taOptions=c.taOptions.filter(function(){return!1}),c.hideOption()},c.selectText=function(a,b){var d=c.taEdit.get(0);d.setSelectionRange&&d.setSelectionRange(a,b)},c.getScrollPos=function(a){var b=0;return c.taOptions.filter(":lt("+c.taOptions.index(a)+")").each(function(){b+=$(this).outerHeight()}),b},c.getHtml=function(a){var d=c.getOptionTemplate({suggestion:a});return d||(d=c.defaultTemplate(a)),b.trustAsHtml(d)},c.defaultTemplate=function(a){if("object"!=typeof a)return a.toString();var b=Object.keys(a),c="";for(i=0;i<b.length-1;i++)c+=a[b[i]]+" ";return c.trim()}},controller:["$scope","$element",function(a,b){}]}}]),angular.module("a11yModule").controller("a11yTypeAheadController",["$scope","$q","$timeout","a11yCommon",function(a,b,c,d){a.name="",a.onItemSelected=function(){console.log(a.name+" Selected")},a.onItemSearchCountries=function(a){var c=b.defer();return c.resolve(d.getFilteredCountries(a)),c.promise},a.onItemSearchStates=function(a){var c=b.defer();return c.resolve(d.getFilteredStates(a)),c.promise},a.onItemSearchCities=function(a){var c=b.defer();return c.resolve(d.getFilteredCities(a)),c.promise},a.getSelectedItemText=function(a){return a.name},a.getOptionTemplate=function(a){return'<div class="custom-type-ahead-option"><div class="code">'+a.code+'</div>&nbsp;&nbsp;<div class="data">'+a.name+"</div></div>"},a.getSelectedItemText1=function(a){return a.name+" "+a.code},a.getOptionTemplate1=function(a){return'<div class="custom-type-ahead-option1"><div class="code">'+a.code+'</div>&nbsp;&nbsp;<div class="data">'+a.name+"</div></div>"}}]),angular.module("a11yComponentsApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="jumbotron hidden"> <h1>Accessible Type Ahead</h1> <p class="lead"> Angular Type Ahead directive with Accessibility. </p> </div> <div class="row marketing"> <h4>HTML</h4> <pre>\n&lt;a11y-type-ahead a11y-uid="AsianCountriesList"\r\n        a11y-aria-label="Asian Countries List"\r\n        on-search="onItemSearchCountries(searchString)"\r\n        get-option-template="getOptionTemplate1(suggestion)"\r\n        get-option-text="getSelectedItemText1(itemSelected)"\r\n        on-select="onItemSelected()"\r\n        selected-text="name" //>\r\n  </pre> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div> <form ng-controller="a11yTypeAheadController" autocomplete="off"> <a11y-type-ahead a11y-uid="AsianCountriesList" a11y-aria-label="Asian Countries List" search-treshold="2" on-search="onItemSearchCountries(searchString)" get-option-template="getOptionTemplate1(suggestion)" get-option-text="getSelectedItemText1(itemSelected)" on-select="onItemSelected()" selected-text="name"> <a11y-type-ahead a11y-uid="USStatesList" a11y-aria-label="US States List" on-search="onItemSearchStates(searchString)" get-option-template="getOptionTemplate(suggestion)" get-option-text="getSelectedItemText(itemSelected)" on-select="onItemSelected()" selected-text="name"> </a11y-type-ahead> <a11y-type-ahead a11y-uid="USCites" search-treshold="1" on-search="onItemSearchCities(searchString)" on-select="onItemSelected()" selected-text="name"> </a11y-type-ahead> </form>')}]);